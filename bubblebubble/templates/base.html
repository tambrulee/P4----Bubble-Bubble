{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Moon & Moss | Handmade & Organic Soaps</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="{% static 'img/favicon.png' %}">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
          rel="stylesheet">
    <!-- Your custom CSS -->
    <link rel="stylesheet" href="{% static 'css/main.css' %}">
    {% block extra_css %}{% endblock %}
    <!-- Font Awesome -->
    <script src="https://kit.fontawesome.com/40f053d397.js"
            crossorigin="anonymous"></script>
  </head>
  <body>
    <!-- Navigation -->
<nav class="navbar navbar-light navbar-pink bb-navbar sticky-top">
  <div class="container bb-nav-grid">

    <!-- LEFT: burger (mobile only) -->
    <div class="bb-nav-left d-lg-none">
      <button class="navbar-toggler border-0 bb-icon-button"
              type="button"
              data-bs-toggle="collapse"
              data-bs-target="#mainNav"
              aria-controls="mainNav"
              aria-expanded="false"
              aria-label="Toggle navigation">
        <span class="bb-icon">☰</span>
      </button>
    </div>

    <!-- LOGO -->
    <div class="bb-nav-center">
      <a class="navbar-brand bb-brand" href="{% url 'catalog:home' %}">
        <img src="{% static 'img/logo.png' %}" alt="Moon & Moss" class="bb-logo">
      </a>
    </div>

    <!-- DESKTOP LINKS (inline, desktop only) -->
    <div class="bb-nav-links-wrap d-none d-lg-flex">
      <ul class="navbar-nav bb-nav-links bb-nav-links-desktop">
        <li class="nav-item"><a class="nav-link" href="{% url 'catalog:product_list' %}">Shop All</a></li>
        <li class="nav-item"><a class="nav-link" href="{% url 'catalog:winter_isles' %}">Winter Isles</a></li>
        <li class="nav-item"><a class="nav-link" href="{% url 'catalog:refillables' %}">Refillables</a></li>
        <li class="nav-item"><a class="nav-link" href="{% url 'catalog:about' %}">Our Story</a></li>
        {% if user.is_authenticated %}
          <li class="nav-item"><a class="nav-link" href="{% url 'accounts:my_orders' %}">My Orders</a></li>
        {% endif %}
      </ul>
    </div>

    <!-- RIGHT: icons -->
    <div class="bb-nav-right bb-nav-icons">
      {% if user.is_authenticated %}
        <a href="#" class="bb-icon-link" title="My account">
          <span class="bb-icon"><i class="fa-regular fa-user"></i></span>
        </a>
        <a href="{% url 'accounts:logout' %}?next={{ request.get_full_path }}"
           class="bb-icon-link"
           title="Logout">
          <span class="bb-icon"><i class="fa-solid fa-right-from-bracket"></i></span>
        </a>
      {% else %}
        <a href="{% url 'accounts:login' %}?next={{ request.get_full_path }}"
           class="bb-icon-link"
           title="Login">
          <span class="bb-icon"><i class="fa-regular fa-user"></i></span>
        </a>
      {% endif %}

      <a href="{% url 'cart:view' %}"
         class="bb-icon-link position-relative"
         title="Cart"
         data-bs-toggle="offcanvas"
         data-bs-target="#miniCart"
         aria-controls="miniCart">
        <span class="bb-icon"><i class="fa-solid fa-cart-shopping"></i></span>
        <span id="cart-count"
              class="position-absolute top-0 start-100 translate-middle badge rounded-pill text-bg-danger {% if cart_count|default:0|add:0 <= 0 %}d-none{% endif %}">
          {{ cart_count|default:0 }}
        </span>
      </a>
    </div>

  </div>

  <!-- MOBILE LINKS (collapse) -->
  <div class="bb-main-links navbar-collapse collapse d-lg-none" id="mainNav">
    <div class="container">
      <ul class="navbar-nav mx-auto bb-nav-links text-center">
        <li class="nav-item"><a class="nav-link" href="{% url 'catalog:product_list' %}">Shop All</a></li>
        <li class="nav-item"><a class="nav-link" href="{% url 'catalog:winter_isles' %}">Winter Isles</a></li>
        <li class="nav-item"><a class="nav-link" href="{% url 'catalog:refillables' %}">Refillables</a></li>
        <li class="nav-item"><a class="nav-link" href="{% url 'catalog:about' %}">Our Story</a></li>
        {% if user.is_authenticated %}
          <li class="nav-item"><a class="nav-link" href="{% url 'accounts:my_orders' %}">My Orders</a></li>
        {% endif %}
      </ul>
    </div>
  </div>
</nav>




    <!-- Scrolling bar -->
    <div class="bb-promo-bar">
      <div class="bb-promo-track">
        <span>Free UK shipping when you spend over £40</span>
        <span>Hand-poured small batch soaps & candles</span>
        <span>Last date for guaranteed Christmas delivery – 19th December</span>
      </div>
    </div>
    <!-- Toast container for "Added to cart" -->
    <div class="toast-container position-fixed bottom-0 end-0 p-3"
         style="z-index: 1080">
      <div id="cart-toast"
           class="toast align-items-center"
           role="alert"
           aria-live="assertive"
           aria-atomic="true">
        <div class="d-flex">
          <div id="cart-toast-body" class="toast-body">Added to cart.</div>
          <button type="button"
                  class="btn-close me-2 m-auto"
                  data-bs-dismiss="toast"
                  aria-label="Close"></button>
        </div>
      </div>
    </div>
    <!-- Main -->
    <main class="container py-4">
      {% block content %}{% endblock %}
    </main>
    <!-- MINI CART OFFCANVAS -->
    <div class="offcanvas offcanvas-end"
         tabindex="-1"
         id="miniCart"
         aria-labelledby="miniCartLabel"
         data-mini-url="{% url 'cart:mini' %}">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="miniCartLabel">Your cart</h5>
        <button type="button"
                class="btn-close"
                data-bs-dismiss="offcanvas"
                aria-label="Close"></button>
      </div>
      <div class="offcanvas-body">
        <div id="mini-cart-content">
          <div class="text-muted">Loading…</div>
        </div>
      </div>
    </div>
  </body>
  <footer class="border-top mt-4 py-3">
    <div class="container text-muted small d-flex justify-content-between">
      <span>© {{ now|default:"2025" }} Moon & Moss</span>
      <span>Handmade • Organic Soaps • Ethical & Sustainable</span>
    </div>
  </footer>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://js.stripe.com/v3/"></script>
  <!-- External cart AJAX JS -->
  <script src="{% static 'js/cart.js' %}"></script>
  {% block extra_js %}{% endblock %}
  {% block scripts %}
  {% endblock %}
</body>
</html>
