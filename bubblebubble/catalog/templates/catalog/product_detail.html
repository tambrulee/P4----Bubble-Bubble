{% extends "base.html" %}
{% block content %}

<div class="row">
    <div class="col-md-6 mb-3">
    {% if product.images.all %}
      <div class="border rounded p-2">
        <img id="main-img"
            src="{{ product.images.first.image.url }}"
            class="img-fluid"
            alt="{{ product.images.first.alt_text }}">
      </div>
      <div class="d-flex gap-2 mt-2 flex-wrap">
        {% for img in product.images.all %}
          <img src="{{ img.image.url }}"
              data-src="{{ img.image.url }}"
              class="thumb border rounded"
              style="height:70px;cursor:pointer;"
              alt="{{ img.alt_text }}">
        {% endfor %}
      </div>
    {% else %}
      <div class="border rounded p-3 text-muted">
        No images yet.
      </div>
    {% endif %}
  </div>

  <div class="col-md-6 mb-3">
    <h1 class="h3">{{ product.title }}</h1>
    <p class="text-muted">
      {{ product.scent }} • {{ product.weight_g }}g • {{ product.get_product_type_display }}
    </p>
    <p class="h4 mb-3">£{{ product.price }}</p>

    <p>{{ product.description }}</p>

    <form id="add-form" method="post" action="{% url 'cart:add' product.id %}">
      {% csrf_token %}
      <div class="input-group mb-3" style="max-width: 220px;">
        <span class="input-group-text">Qty</span>
        <input type="number" name="qty" value="1" min="1" max="{{ product.stock_qty }}" class="form-control">
      </div>
      <button type="submit" class="btn btn-primary">Add to cart</button>
    </form>
  </div>
</div>

{% endblock %}

{% block scripts %}
<script>
  // Swap main image when hovering/clicking a thumbnail
  document.querySelectorAll('.thumb').forEach((thumb) => {
    thumb.addEventListener('mouseenter', () => {
      const main = document.getElementById('main-img');
      if (main && thumb.dataset.src) {
        main.src = thumb.dataset.src;
      }
    });
  });
</script>
{% endblock %}

